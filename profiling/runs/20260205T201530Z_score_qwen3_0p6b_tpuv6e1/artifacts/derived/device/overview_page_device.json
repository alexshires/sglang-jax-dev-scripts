[{"cols":[{"id":"selfTimePercent","label":"Time (%)","type":"number"},{"id":"cumulativeTimePercent","label":"Cumulative time (%)","type":"number"},{"id":"category","label":"Category","type":"string"},{"id":"operation","label":"Operation","type":"string"},{"id":"flopRate","label":"Bf16 Normalized Flop Rate(GFLOPs/Sec)","type":"number"}],"p":{"device_duty_cycle_percent":"0.0%","device_idle_time_percent":"0.0%","device_op_time_eager_percent":"0.0%","device_tf_op_percent":"92.0%","flop_rate_utilization_relative_to_roofline":"0.0%","hbm_utilization_percent":"0.0%","host_idle_time_percent":"0.0%","host_op_time_eager_percent":"0.0%","host_tf_op_percent":"8.0%","host_trace_level":"0","memory_bw_utilization_relative_to_hw_limit":"0.0%","mxu_utilization_percent":"0.0%","remark_color":"","remark_text":""},"rows":[{"c":[{"v":0.3607691955478313},{"v":0.3607691955478313},{"v":"pallas_call"},{"v":"jit(jitted_run_model)/QWen3Attention/FlashAttention/jit(ragged_paged_attention)/RPA-bq_32-bkvp_512-p_1-/pallas_call"},{"v":165897.55060161516}]},{"c":[{"v":0.15977261370807677},{"v":0.5205418092559081},{"v":"dot_general"},{"v":"jit(jitted_run_model)/LogitsProcessor/dot_general"},{"v":3101.7350619575986}]},{"c":[{"v":0.08122858672909736},{"v":0.6017703959850055},{"v":"reduce_sum"},{"v":"jit(jitted_sampler)/Sampler/cond/branch_0_fun/while/body/closed_call/reduce_sum"},{"v":831.1265437166841}]},{"c":[{"v":0.057124286058405346},{"v":0.6588946820434108},{"v":"dot_general"},{"v":"jit(jitted_run_model)/Qwen3MLP/down_proj/dot_general"},{"v":314914.44975169457}]},{"c":[{"v":0.05677988202668833},{"v":0.7156745640700992},{"v":"transpose"},{"v":"jit(jitted_run_model)/QWen3Attention/FlashAttention/jit(ragged_paged_attention)/transpose"},{"v":0.0}]},{"c":[{"v":0.03296225291996886},{"v":0.7486368169900681},{"v":"dot_general"},{"v":"jit(jitted_run_model)/Qwen3MLP/gate_proj/dot_general"},{"v":272544.2653540691}]},{"c":[{"v":0.023920154006334644},{"v":0.7725569709964027},{"v":"reduce"},{"v":"jit(jitted_sampler)/Sampler/cond/branch_0_fun/cond/branch_0_fun/reduce"},{"v":2109.1851025758397}]},{"c":[{"v":0.022596288797711406},{"v":0.7951532597941141},{"v":"dot_general"},{"v":"jit(jitted_run_model)/QWen3Attention/o_proj/dot_general"},{"v":265134.78729571385}]},{"c":[{"v":0.01841367104836189},{"v":0.813566930842476},{"v":"dot_general"},{"v":"jit(jitted_run_model)/QWen3Attention/q_proj/dot_general"},{"v":325518.25789502135}]},{"c":[{"v":0.013759239683307552},{"v":0.8273261705257835},{"v":"dot_general"},{"v":"jit(jitted_run_model)/QWen3Attention/k_proj/dot_general"},{"v":218029.16437821023}]}]},{"cols":[{"id":"stepnum","label":"stepnum","type":"string"},{"id":"tcComputeTimeMs","label":"TensorCore compute (in ms)","type":"number"},{"id":"scv0ComputeTimeMs","label":"SparseCoreV0 compute (in ms)","type":"number"},{"id":"scv0InfeedTimeMs","label":"SparseCoreV0 input (in ms)","type":"number"},{"id":"tcInfeedTimeMs","label":"TensorCore input (in ms)","type":"number"},{"id":"tcOutfeedTimeMs","label":"TensorCore output (in ms)","type":"number"},{"id":"tcIdleTimeMs","label":"TensorCore idle (in ms)","type":"number"},{"id":"hostTransferTimeMs","label":"Host transfer (in ms)","type":"number"},{"id":"tooltip","label":"tooltip","p":{"role":"tooltip"},"type":"string"},{"id":"infeedPercentAverage","label":"% step time waiting for input data","type":"number"},{"id":"infeedPercentMin","label":"Infeed percent min","p":{"role":"interval"},"type":"number"},{"id":"infeedPercentMax","label":"Infeed percent max","p":{"role":"interval"},"type":"number"}],"p":{"hardware_type":"TPU","host_transfer_ms_average":"0.00","infeed_percent_average":"0.0","infeed_percent_maximum":"0.0","infeed_percent_minimum":"0.0","infeed_percent_standard_deviation":"0.0","input_conclusion":"No step time measured. Therefore we cannot tell where the performance bottleneck is.","output_conclusion":"","scv0_compute_ms_average":"0.00","scv0_infeed_ms_average":"0.00","step_time_graph_column_ids":"stepnum,tcComputeTimeMs,scv0ComputeTimeMs,scv0InfeedTimeMs,tcInfeedTimeMs,tcOutfeedTimeMs,tcIdleTimeMs,hostTransferTimeMs,tooltip","steptime_ms_average":"0.0","steptime_ms_maximum":"0.0","steptime_ms_minimum":"0.0","steptime_ms_standard_deviation":"0.0","summary_nextstep":"You may skip the rest of this page.","tc_compute_ms_average":"0.00","tc_idle_ms_average":"0.00","tc_infeed_ms_average":"0.00","tc_outfeed_ms_average":"0.00"},"rows":[]},{"cols":[{"id":"host_id","label":"host_id","type":"string"},{"id":"command_line","label":"command_line","type":"string"},{"id":"start_time","label":"start_time","type":"string"},{"id":"bns_address","label":"bns_address","type":"string"}],"p":{"device_core_count":"1","device_type":"TPU v6 Lite","host_count":"1","is_training":"false","task_count":"1 (num tasks per host = 1)"},"rows":[]},{"cols":[{"id":"tip_type","label":"tip_type","type":"string"},{"id":"link","label":"link","type":"string"},{"id":"description","label":"description","type":"string"}],"p":{"all_other_bottleneck":"no","all_other_statement":"","bottleneck":"unknown","device_collectives_bottleneck":"no","device_collectives_statement":"","kernel_launch_bottleneck":"no","kernel_launch_statement":"","non_bottleneck_tip_types":"","precision_statement":"","statement":"No step time measured. Therefore we cannot tell where the performance bottleneck is."},"rows":[{"c":[{"v":"faq"},{"v":"Refer to the TF2 Profiler FAQ"},{"v":"Tool troubleshooting / FAQ"}]},{"c":[{"v":"host"},{"v":"input_pipeline_analyzer (especially Section 3 for the breakdown of input operations on the Host)"},{"v":"Next steps for reducing the Host time"}]},{"c":[{"v":"host"},{"v":"trace_viewer (look at the activities on the timeline of each Host Thread near the bottom of the trace view)"},{"v":"Next steps for reducing the Host time"}]},{"c":[{"v":"device"},{"v":"op_profile (identify the time-consuming operations executed on the TPU)"},{"v":"Next steps for reducing the Device time"}]},{"c":[{"v":"device"},{"v":"trace_viewer (look at the activities on the timeline of each TPU core in the trace view)"},{"v":"Next steps for reducing the Device time"}]},{"c":[{"v":"doc"},{"v":"<a href=\"https://www.tensorflow.org/guide/data_performance_analysis\" target=\"_blank\">Analyze tf.data performance with the TF Profiler</a>"},{"v":"Other useful resources"}]},{"c":[{"v":"doc"},{"v":"<a href=\"https://www.tensorflow.org/guide/data_performance\" target=\"_blank\">Better performance with the tf.data API</a>"},{"v":"Other useful resources"}]}]},{"cols":[{"id":"percentile","label":"percentile","type":"string"},{"id":"hostTimeMs","label":"Host time (in ms)","type":"number"},{"id":"deviceTimeMs","label":"Device time (in ms)","type":"number"},{"id":"communicationTimeMs","label":"Host-device communication time (in ms)","type":"number"},{"id":"totalTimeMs","label":"Total latency (in ms)","type":"number"}],"rows":[]}, {},{"cols":[{"id":"severity","label":"Severity","type":"string"},{"id":"message","label":"Message","type":"string"}],"rows":[{"c":[{"v":"WARNING"},{"v":"No step marker observed and hence the step time is unknown. This may happen if (1) training steps are not instrumented (e.g., if you are not using Keras) or (2) the profiling duration is shorter than the step time. For (1), you need to add step instrumentation; for (2), you may try to profile longer."}]}]}]