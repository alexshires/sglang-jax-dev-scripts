/home/kanna/work/sglang-jax/.venv/lib/python3.12/site-packages/jax/_src/cloud_tpu_init.py:93: UserWarning: Transparent hugepages are not enabled. TPU runtime startup and shutdown time should be significantly improved on TPU v5e and newer. If not already set, you may need to enable transparent hugepages in your VM image (sudo sh -c "echo always > /sys/kernel/mm/transparent_hugepage/enabled")
  warnings.warn(
Fetching 6 files:   0%|          | 0/6 [00:00<?, ?it/s]Fetching 6 files: 100%|██████████| 6/6 [00:00<00:00, 120410.64it/s]
/home/kanna/work/sglang-jax/.venv/lib/python3.12/site-packages/jax/_src/cloud_tpu_init.py:93: UserWarning: Transparent hugepages are not enabled. TPU runtime startup and shutdown time should be significantly improved on TPU v5e and newer. If not already set, you may need to enable transparent hugepages in your VM image (sudo sh -c "echo always > /sys/kernel/mm/transparent_hugepage/enabled")
  warnings.warn(
Fetching 6 files:   0%|                                  | 0/6 [00:00<?, ?it/s]Fetching 6 files: 100%|██████████████████████| 6/6 [00:00<00:00, 122164.19it/s]
Fetching 6 files:   0%|                                  | 0/6 [00:00<?, ?it/s]Fetching 6 files: 100%|██████████████████████| 6/6 [00:00<00:00, 109894.43it/s]
Fetching 12 files:   0%|                                | 0/12 [00:00<?, ?it/s]Fetching 12 files: 100%|███████████████████| 12/12 [00:00<00:00, 188508.04it/s]
Scanning Metadata:   0%|                               | 0/2 [00:00<?, ?file/s]Scanning Metadata: 100%|██████████████████████| 2/2 [00:00<00:00, 343.65file/s]
Loading Regular Weights:   0%|                         | 0/310 [00:00<?, ?it/s]Loading Regular Weights:   0%|                 | 1/310 [00:00<01:38,  3.15it/s]Loading Regular Weights:   2%|▎                | 6/310 [00:00<00:19, 15.71it/s]Loading Regular Weights:   4%|▌               | 11/310 [00:00<00:13, 22.59it/s]Loading Regular Weights:   8%|█▏              | 24/310 [00:00<00:05, 49.73it/s]Loading Regular Weights:  16%|██▍            | 50/310 [00:00<00:02, 106.17it/s]Loading Regular Weights:  25%|███▋           | 77/310 [00:00<00:01, 150.37it/s]Loading Regular Weights:  36%|█████         | 111/310 [00:01<00:00, 202.54it/s]Loading Regular Weights:  46%|██████▍       | 143/310 [00:01<00:00, 235.33it/s]Loading Regular Weights:  57%|███████▉      | 176/310 [00:01<00:00, 260.55it/s]Loading Regular Weights:  68%|█████████▍    | 210/310 [00:01<00:00, 279.31it/s]Loading Regular Weights:  78%|██████████▉   | 242/310 [00:01<00:00, 290.51it/s]Loading Regular Weights:  88%|████████████▎ | 272/310 [00:01<00:00, 272.84it/s]Loading Regular Weights:  97%|█████████████▌| 301/310 [00:01<00:00, 257.34it/s]Loading Regular Weights: 100%|██████████████| 310/310 [00:01<00:00, 179.78it/s]
Loading MoE Weights: 0it [00:00, ?it/s]Loading MoE Weights: 0it [00:00, ?it/s]
[EXTEND] PRECOMPILE:   0%|                               | 0/7 [00:00<?, ?it/s][EXTEND] PRECOMPILE:   0%|              | 0/7 [00:00<?, ?it/s, bs=3, tokens=64][EXTEND] PRECOMPILE:  14%|▊     | 1/7 [00:06<00:37,  6.22s/it, bs=3, tokens=64][EXTEND] PRECOMPILE:  14%|▋    | 1/7 [00:06<00:37,  6.22s/it, bs=3, tokens=128][EXTEND] PRECOMPILE:  29%|█▍   | 2/7 [00:11<00:29,  5.83s/it, bs=3, tokens=128][EXTEND] PRECOMPILE:  29%|█▍   | 2/7 [00:11<00:29,  5.83s/it, bs=3, tokens=256][EXTEND] PRECOMPILE:  43%|██▏  | 3/7 [00:17<00:23,  5.91s/it, bs=3, tokens=256][EXTEND] PRECOMPILE:  43%|██▏  | 3/7 [00:17<00:23,  5.91s/it, bs=3, tokens=512][EXTEND] PRECOMPILE:  57%|██▊  | 4/7 [00:26<00:20,  6.94s/it, bs=3, tokens=512][EXTEND] PRECOMPILE:  57%|██▎ | 4/7 [00:26<00:20,  6.94s/it, bs=3, tokens=1024][EXTEND] PRECOMPILE:  71%|██▊ | 5/7 [00:36<00:16,  8.03s/it, bs=3, tokens=1024][EXTEND] PRECOMPILE:  71%|██▊ | 5/7 [00:36<00:16,  8.03s/it, bs=3, tokens=2048][EXTEND] PRECOMPILE:  86%|███▍| 6/7 [00:47<00:09,  9.27s/it, bs=3, tokens=2048][EXTEND] PRECOMPILE:  86%|███▍| 6/7 [00:47<00:09,  9.27s/it, bs=3, tokens=4096][EXTEND] PRECOMPILE: 100%|████| 7/7 [00:57<00:00,  9.43s/it, bs=3, tokens=4096]                                                                               [DECODE] PRECOMPILE:   0%|                               | 0/3 [00:00<?, ?it/s][DECODE] PRECOMPILE:   0%|                         | 0/3 [00:00<?, ?it/s, bs=1][DECODE] PRECOMPILE:  33%|█████▋           | 1/3 [00:05<00:10,  5.40s/it, bs=1][DECODE] PRECOMPILE:  33%|█████▋           | 1/3 [00:05<00:10,  5.40s/it, bs=2][DECODE] PRECOMPILE:  67%|███████████▎     | 2/3 [00:11<00:05,  5.66s/it, bs=2][DECODE] PRECOMPILE:  67%|███████████▎     | 2/3 [00:11<00:05,  5.66s/it, bs=3][DECODE] PRECOMPILE: 100%|█████████████████| 3/3 [00:15<00:00,  5.20s/it, bs=3]                                                                               ..
=============================== warnings summary ===============================
../sglang-jax/.venv/lib/python3.12/site-packages/jax/_src/cloud_tpu_init.py:93
  /home/kanna/work/sglang-jax/.venv/lib/python3.12/site-packages/jax/_src/cloud_tpu_init.py:93: UserWarning: Transparent hugepages are not enabled. TPU runtime startup and shutdown time should be significantly improved on TPU v5e and newer. If not already set, you may need to enable transparent hugepages in your VM image (sudo sh -c "echo always > /sys/kernel/mm/transparent_hugepage/enabled")
    warnings.warn(

test/srt/test_multi_item_prefill_extend.py::TestMultiItemPrefillExtend::test_prefill_extend_batching
  /home/kanna/work/sglang-jax-bench-f9d3fb5/python/sgl_jax/srt/utils/common_utils.py:648: DeprecationWarning: There is no current event loop
    loop = asyncio.get_event_loop()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
2 passed, 2 warnings in 113.99s (0:01:53)
/usr/lib/python3.12/multiprocessing/resource_tracker.py:123: UserWarning: resource_tracker: process died unexpectedly, relaunching.  Some resources might leak.
  warnings.warn('resource_tracker: process died unexpectedly, '
Traceback (most recent call last):
  File "/usr/lib/python3.12/multiprocessing/resource_tracker.py", line 239, in main
    cache[rtype].remove(name)
KeyError: '/mp-hyn5jc0t'
